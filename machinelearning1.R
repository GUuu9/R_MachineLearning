library(lpSolve)

# 7 - 15페이지 배낭문제
obj <- c(75,20,40,50,30,25,15)
const <- matrix(c(5,2,1.2,4,2.5,4.5,0.5),
                byrow = T, ncol =7)
direction <- "<="
rhs <- 12 #우변


sol <- lp("max", obj, const, direction, rhs,
          binary.vec = 1:7)
sol
sol$solution


##################################
obj <- c(40, 30, 50, 45)
const <- matrix(c(10, 1, 5, 10,
                10, 20, 30, 15,
                10, 5, 20, 15),
                byrow = T, ncol = 4)
direction <- c("<=", "<=", "<=")
rhs <- c(20,60,40)

sol <- lp("max", obj, const,
          direction, rhs, binary.vec = 1:4)

sol
sol$solution

##################################
#미해결 7-20p
###################
obj <- c(300, 100, 200, 2, 10 ,5)
const <- matrix(c(0, 0, 0, 1, 1, 1,
                  -8000, 0, 0, 1, 0, 0,
                  0, -13000, 0, 0, 1, 0,
                  0, 0, -14000, 0, 0, 1),
                byrow = T, ncol = 6)
direction <- c(">=", "<=", "<=", "<=")
rhs <- c(20000,0,0,0)

sol <- lp("max", obj, const,
          direction, rhs, binary.vec = 1:6)

sol
sol$solution

##################################
#미해결 7-22p
###################
obj <- c(1, 1, 1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 0, 1, 0, 0, 0, 0, 0, 0,
                  0, 1, 1, 0, 0, 0, 0, 0, 0,
                  0, 0, 1, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 1, 1, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 0, 1,
                  0, 0, 0, 0, 1, 1, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1, 1),
                byrow = T, ncol = 9)
direction <- c(">=", ">=",">=",">=",">=",">=",">=",">=",">=")
rhs <- c(1,1,1,1,1,1,1,1,1)

sol <- lp("max", obj, const,
          direction, rhs, binary.vec = 1:9)

sol
sol$solution


##################################
#미해결 7-24p
###################
obj <- c(1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 1, 1, 1, 0, 0, 0,
                  1, 1, 1, 0, 1, 0, 0,
                  1, 1, 1, 1, 1, 1, 0,
                  1, 0, 1, 1, 0, 1, 1,
                  0, 1, 1, 0, 1, 1, 0,
                  0, 0, 1, 1, 1, 1, 1,
                  0, 0, 0, 1, 0, 1, 1,
                  1, 0, 0, 1, 0, 0, 0),
                byrow = T, ncol = 7)
direction <- c(">=", ">=",">=",">=",">=",">=",">=","=")
rhs <- c(1,1,1,1,1,1,1,1)

sol <- lp("max", obj, const,
          direction, rhs, binary.vec = 1:7)

sol
sol$solution

##################################
#농구선수문제 과제
###################
library(lpSolve)
obj <- c(1, 1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 1, 1, 1, 1, 1, 1, 1,
                  182, 175, 185, 190, 196, 201, 203, 208,
                  1, 3, 3, 4, 2, 6, 3, 9,
                  4, 16, 4, 10, 12, 8, 6, 22,
                  5, 2, 1, 2, 3, 1, 5, 1,
                  1, 1, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1,
                  1, 0, 0, 1, 0, 2, 0, 0),
                byrow = T, ncol = 8)
direction <- c("==",">=", ">=", ">=", ">=", ">=", "==", "<=")
rhs <- c(5,965,23,58,13,1,1,2)

sol <- lp("max", obj, const, direction, rhs, binary.vec = 1:8)

sol
sol$solution

####
# 목표조건 3 제외

library(lpSolve)
obj <- c(1, 1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 1, 1, 1, 1, 1, 1, 1,
                  182, 175, 185, 190, 196, 201, 203, 208,
                  1, 3, 3, 4, 2, 6, 3, 9,
                  4, 16, 4, 10, 12, 8, 6, 22,
                  1, 1, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1,
                  1, 0, 0, 1, 0, 2, 0, 0),
                byrow = T, ncol = 8)
direction <- c("==", ">=", ">=", ">=", ">=", "==", "<=")
rhs <- c(5, 965, 23, 58, 1, 1, 2)

sol <- lp("max", obj, const, direction, rhs, binary.vec = 1:8)

sol
sol$solution

####
# 목표조건 4 제외
obj <- c(1, 1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 1, 1, 1, 1, 1, 1, 1,
                  182, 175, 185, 190, 196, 201, 203, 208,
                  1, 3, 3, 4, 2, 6, 3, 9,
                  4, 16, 4, 10, 12, 8, 6, 22,
                  1, 1, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1,
                  1, 0, 0, 1, 0, 2, 0, 0),
                byrow = T, ncol = 8)
direction <- c("==",">=", ">=", ">=", ">=", "==", "<=")
rhs <- c(5,965,23,58,1,1,2)

sol <- lp("max", obj, const, direction, rhs, binary.vec = 1:8)

sol
sol$solution
# 목표조건 2 제외
obj <- c(1, 1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 1, 1, 1, 1, 1, 1, 1,
                  182, 175, 185, 190, 196, 201, 203, 208,
                  4, 16, 4, 10, 12, 8, 6, 22,
                  5, 2, 1, 2, 3, 1, 5, 1,
                  1, 1, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1,
                  1, 0, 0, 1, 0, 2, 0, 0),
                byrow = T, ncol = 8)
direction <- c("==",">=", ">=", ">=", ">=", "==", "<=")
rhs <- c(5,965,58,13,1,1,2)

sol <- lp("max", obj, const, direction, rhs, binary.vec = 1:8)

sol
sol$solution

library(lpSolve)
obj <- c(1, 1, 1, 1, 1, 1, 1, 1)
const <- matrix(c(1, 1, 1, 1, 1, 1, 1, 1,
                  1, 3, 3, 4, 2, 6, 3, 9,
                  4, 16, 4, 10, 12, 8, 6, 22,
                  5, 2, 1, 2, 3, 1, 5, 1,
                  1, 1, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1,
                  1, 0, 0, 1, 0, 2, 0, 0),
                byrow = T, ncol = 8)
direction <- c("==", ">=", ">=", ">=", ">=", "==", "<=")
rhs <- c(5,23,58,13,1,1,2)

sol <- lp("max", obj, const, direction, rhs, binary.vec = 1:8)

sol
sol$solution

#균형수송 문제
library(lpSolve)
obj <- c(8, 9, 11, 16, 12, 7, 5, 8, 14, 10, 6, 7)
const <- matrix(c(1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
                  1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0,
                  0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,
                  0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
                  0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1),
                byrow = T, ncol = 12)
direction <- c("==", "==", "==", "==", "==", "==", "==")
rhs <- c(50,80, 120, 90, 70, 40, 50)

sol <- lp("min", obj, const, direction, rhs, binary.vec = 1:12)

sol
sol$solution

#불균형 수송
obj <- c(8, 9, 11, 16, 12, 7, 5, 8, 14, 10, 6, 7)
const <- matrix(c(1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
                  1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0,
                  0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,
                  0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
                  0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1),
                byrow = T, ncol = 12)
direction <- c("<=", "==", "==", "==", ">=", ">=", "==")
rhs <- c(50, 80, 120, 90, 70, 40, 50)

sol <- lp("min", obj, const, direction, rhs, binary.vec = 1:12)

sol
sol$solution

# 중계 수송
obj <- c(200, 300, 300,100, 200, 600, 300, 600,400, 400, 600, 500)
const <- matrix(c(1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
                  1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0,
                  0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,
                  0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
                  0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1),
                byrow = T, ncol = 12)
direction <- c("<=", "==", "==", "==", ">=", ">=", "==")
rhs <- c(50, 80, 120, 90, 70, 40, 50)

sol <- lp("min", obj, const, direction, rhs, binary.vec = 1:12)

sol
sol$solution

# 할당 모형
obj <- c(27, 31, 60, 49, 38, 37, 34, 27, 35)
const <- matrix(c(1, 1, 1, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 1, 1, 1, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1, 1,
                  1, 0, 0, 1, 0, 0, 1, 0, 0,
                  0, 1, 0, 0, 1, 0, 0, 1, 0,
                  0, 0, 1, 0, 0, 1, 0, 0, 1),
                byrow = T, ncol = 9)
direction <- c("<=", "<=", "<=", ">=", ">=", ">=")
rhs <- c(1, 1, 1, 1, 1, 1)

sol <- lp("min", obj, const, direction, rhs, binary.vec = 1:9)

sol
sol$solution

# 할당 모형
obj <- c(10, 20, 20, 5, 15, 35, 35, 30, 20, 15, 15, 10, 20)
const <- matrix(c(1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1,
                  1, 0, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0,
                  0, 1, 0, 1, 0, 0, -1, -1, 0, 0, 0, 0, 0,
                  0, 0, 1, 0, 1, 0, 0, 0, -1, -1, 0, 0, 0,
                  0, 0, 0, 0, 0, 1, 1, 0, 1, 0, -1, 1, 0,
                  0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, -1, -1),
                byrow = T, ncol = 13)
direction <- c("==", "==", "==", "==", "==", "==", "==")
rhs <- c(1, 1, 0, 0, 0, 0, 0)

sol <- lp("min", obj, const, direction, rhs, binary.vec = 1:13)

sol
sol$solution

